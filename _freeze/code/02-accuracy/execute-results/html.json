{
  "hash": "9eb6f335b28811bf4a44b905f26fe0ac",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"02-shallow\"\nauthor: \"Stefano Coretta\"\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(ggeffects)\nlibrary(simr)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: lme4\nLoading required package: Matrix\n\nAttaching package: 'Matrix'\n\nThe following objects are masked from 'package:tidyr':\n\n    expand, pack, unpack\n\n\nAttaching package: 'simr'\n\nThe following object is masked from 'package:lme4':\n\n    getData\n\nThe following object is masked from 'package:stringr':\n\n    fixed\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nshallow <- read_csv(\"data/song2020/shallow.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 6500 Columns: 11\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (8): Group, ID, List, Target, Critical_Filler, Word_Nonword, Relation_ty...\ndbl (3): ACC, RT, logRT\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code}\nshallow_l2 <- shallow |> \n  filter(Group == \"L2\", Branching == \"Left\")\n\nset.seed(9823)\nshallow_s <- shallow_l2 |> \n  distinct(ID) |> \n  slice_sample(n = 10) |> \n  inner_join(shallow_l2, by = \"ID\") |> \n  filter(Branching == \"Left\") |> \n  droplevels()\n\nsaveRDS(shallow_s, \"data/shallow_s.rds\")\nunique(shallow_s$ID)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \"L2_36\" \"L2_18\" \"L2_35\" \"L2_24\" \"L2_03\" \"L2_11\" \"L2_37\" \"L2_10\" \"L2_30\"\n[10] \"L2_26\"\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsha_lm <- glmer(\n  ACC ~ Relation_type + (Relation_type | ID),\n  family = binomial,\n  data = shallow_s\n)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in checkConv(attr(opt, \"derivs\"), opt$par, ctrl = control$checkConv, :\nModel failed to converge with max|grad| = 0.00637234 (tol = 0.002, component 1)\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(sha_lm)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGeneralized linear mixed model fit by maximum likelihood (Laplace\n  Approximation) [glmerMod]\n Family: binomial  ( logit )\nFormula: ACC ~ Relation_type + (Relation_type | ID)\n   Data: shallow_s\n\n     AIC      BIC   logLik deviance df.resid \n   243.9    272.7   -113.0    225.9      171 \n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-1.8220 -1.1732  0.5994  0.7376  0.9667 \n\nRandom effects:\n Groups Name                        Variance Std.Dev. Corr       \n ID     (Intercept)                 0.5606   0.7487              \n        Relation_typeNonConstituent 0.1617   0.4022   -1.00      \n        Relation_typeUnrelated      0.2396   0.4895   -1.00  1.00\nNumber of obs: 180, groups:  ID, 10\n\nFixed effects:\n                              Estimate Std. Error z value Pr(>|z|)  \n(Intercept)                  0.8699404  0.3904283   2.228   0.0259 *\nRelation_typeNonConstituent  0.0008542  0.4401554   0.002   0.9985  \nRelation_typeUnrelated      -0.3867280  0.4379963  -0.883   0.3773  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n            (Intr) Rlt_NC\nRltn_typNnC -0.730       \nRltn_typUnr -0.777  0.596\noptimizer (Nelder_Mead) convergence code: 0 (OK)\nModel failed to converge with max|grad| = 0.00637234 (tol = 0.002, component 1)\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsha_lm_2 <- glmer(\n  ACC ~ Relation_type + (1 | ID),\n  family = binomial,\n  data = shallow_s\n)\n\nsummary(sha_lm_2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nGeneralized linear mixed model fit by maximum likelihood (Laplace\n  Approximation) [glmerMod]\n Family: binomial  ( logit )\nFormula: ACC ~ Relation_type + (1 | ID)\n   Data: shallow_s\n\n     AIC      BIC   logLik deviance df.resid \n   235.1    247.8   -113.5    227.1      176 \n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-1.7702 -1.2415  0.6161  0.7087  0.9373 \n\nRandom effects:\n Groups Name        Variance Std.Dev.\n ID     (Intercept) 0.14     0.3742  \nNumber of obs: 180, groups:  ID, 10\n\nFixed effects:\n                            Estimate Std. Error z value Pr(>|z|)   \n(Intercept)                  0.79468    0.30687   2.590  0.00961 **\nRelation_typeNonConstituent  0.08048    0.40084   0.201  0.84086   \nRelation_typeUnrelated      -0.30295    0.38990  -0.777  0.43716   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n            (Intr) Rlt_NC\nRltn_typNnC -0.643       \nRltn_typUnr -0.665  0.506\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsha_lm_ext <- extend(sha_lm_2, along = \"ID\", n = 1000)\nfixef(sha_lm_ext)[\"Relation_typeNonConstituent\"] <- -0.2\n\nfi <- \"cache/sha_lm_pow.rds\"\n\nif (file.exists(fi)) {\n  sha_lm_pow <- readRDS(fi)\n} else {\n  suppressMessages(\n    sha_lm_pow <- powerCurve(sha_lm_ext, fixed(\"Relation_typeNonConstituent\"), along = \"ID\")\n  )\n  # The following is needed in this case probably because of a bug in powerCurve()\n  sha_lm_pow[[\"xval\"]] <- sha_lm_pow[[\"nlevels\"]]\n  saveRDS(sha_lm_pow, fi)\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nprint(sha_lm_pow)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nPower for predictor 'Relation_typeNonConstituent', (95% confidence interval),\nby largest value of ID:\n      3:  5.00% ( 3.73,  6.54) - 54 rows\n    114: 37.50% (34.49, 40.58) - 2052 rows\n    225: 67.60% (64.60, 70.50) - 4050 rows\n    335: 83.30% (80.84, 85.56) - 6030 rows\n    446: 92.40% (90.58, 93.97) - 8028 rows\n    557: 95.70% (94.25, 96.87) - 10026 rows\n    668: 98.30% (97.29, 99.01) - 12024 rows\n    778: 99.20% (98.43, 99.65) - 14004 rows\n    889: 99.70% (99.13, 99.94) - 16002 rows\n   1000: 100.0% (99.63, 100.0) - 18000 rows\n\nTime elapsed: 1 h 29 m 48 s\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(sha_lm_pow)\n```\n\n::: {.cell-output-display}\n![](02-accuracy_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}